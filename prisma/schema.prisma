// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL") // @prisma-lint-ignore
}

// Admin model for authentication
model Admin {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  email     String   @unique
  password  String // Should be hashed
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Product categories enum
enum ProductCategory {
  CANDLES
  ROOM_SPRAYS
  WAX_MELTS
}

// Products model
model Product {
  id          String          @id @default(auto()) @map("_id") @db.ObjectId
  name        String
  category    ProductCategory
  price       Float
  description String

  // Size/Weight (flexible for different product types)
  bottleSize String? // For room sprays (e.g., "100ml", "250ml")
  weight     String? // For candles and wax melts (e.g., "200g", "8oz")

  ingredients  String[] // Array of ingredients
  scentProfile String // Description of scent
  uses         String // How to use the product
  burnTime     String? // For candles (e.g., "40 hours")

  images       String[] // Array of image URLs
  inStock      Boolean  @default(true)
  isBestSeller Boolean  @default(false) // For homepage best offers section
  isActive     Boolean  @default(true) // Admin can hide products

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([category])
  @@index([isBestSeller])
  @@index([isActive])
}

// Contact form submissions (emails from users)
model ContactMessage {
  id        String        @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  email     String
  subject   String?
  message   String
  isRead    Boolean       @default(false)
  status    MessageStatus @default(PENDING)
  createdAt DateTime      @default(now())

  @@index([isRead])
  @@index([status])
  @@index([createdAt])
}

enum MessageStatus {
  PENDING
  DELIVERED
}

model ContactLog {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  messageId String   @db.ObjectId
  action    String
  details   Json?
  createdAt DateTime @default(now())

  @@index([messageId])
  @@index([createdAt])
}
